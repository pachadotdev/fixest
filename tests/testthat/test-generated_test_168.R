test_that("auto-generated test #168", {
do_refactor = FALSE
do_sum_y = FALSE
nthreads = 4
obs2keep = 0
only_slope = FALSE
r_x_sizes = 0
rm_0 = FALSE
rm_1 = FALSE
rm_single = FALSE
x = structure(list(id = c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 108L, 108L, 108L, 108L, 108L, 108L, 108L, 108L, 108L, 108L)), class = "data.frame", row.names = c(NA, -1080L))
y = c(2.87530627198927, 1.86065272247541, 0.0941652410110443, 3.78147485173024, -2.55819958872084, 1.72873239808121, 6.2842362903016, 4.76688777980834, 5.34753391543637, 4.95146934010457, -4.25798295343388, 0.606110673336697, 5.61637037537262, -6.16941931407346, 0.711868746807948, -0.336991226062583, 6.841531353957, 8.56171921863645, 11.5181303595031, 13.1336338796315, -2.62200324042106, -11.3566246730323, 3.12563423469904, -6.73352997328987, 1.0320532778183, -2.99275313053212, -1.65895913199966, 6.26235903400816, 1.22594179722106, 9.24776630154508, 3.97673305160946, 0.00980974057448752, -3.38198118676449, 7.13202293545957, -4.51202451129925, 7.61583290199938, 8.8939960886191, 3.99144665881084, 7.72056388520135, 11.590347412296, -5.74407836720964, 9.31305106176744, 2.4864415683985, 0.437311102556258, 2.65664739403559, 2.14960151290422, -1.7994104330657, 9.2262419943201, 3.20948431667452, 7.973781635615, 9.32501497054427, 1.28731644451189, -1.28071543916244, 3.58389514113205, 8.10354889918504, 5.43972762867802, 3.23363930658141, 16.6870623316013, 10.257101507255, 6.3388692570085, -2.66363122146583, 9.67079725034933, 7.8169721345112, 5.36904299075171, 4.69559625131237, 5.1188651610995, 10.1934627199067, 12.1812774733132, 7.19941447210929, 6.96397383400889, 1.22187759061005, -5.67962536685635, 0.517586843105434, -8.35205415213259, 5.19162311746977, 5.08496932093759, -2.10344847021145, 4.31925716788469, -4.38945793231368, 9.74357796431702, -5.67768883376378, 0.106350691899116, 0.438422380907934, 8.19824752218061, 2.88451120024275, 5.88912534693404, 8.06546010597877, 3.46348816916525, 3.28402595776171, 1.05479630222277, -0.4037215659337, 0.401509802995104, 2.33212466574917, -2.03348887123475, 2.50934460241966, 0.383817418327338, -1.11140124940908, 5.20091674679846, 12.5361398476822, 4.29219156741135, 15.1529944509057, 2.84255215820787, 7.50773468239604, 5.02127961217432, -0.425232362585823, 16.6134948255945, 7.31706698186264, 9.9287983560089, 6.5872138749457, 20.033928698068, -2.19579501258539, 6.28142313203594, -2.80666981133785, -1.07997095924693, -2.18090220247567, -4.13132889971911, 4.52471833441446, 5.56376244514102, 16.11124427553, 5.09195745184034, 2.09521692303849, 4.50557427950179, -0.830052503291837, -5.80686319880273, 7.71609933497374, 4.45618216385151, 7.1224463795997, 12.6405329156142, -6.39038257429874, 2.53531706081238, 4.26139717576796, -5.16743572991847, 4.26862725043088, -3.55958172461522, 2.30501104086158, -8.13901524220266, 9.467384655853, 11.1183620050384, 8.77121152307526, 5.07329554248602, 2.16482572489593, 0.60227228666965, -7.35240559056057, -4.4757678813766, 3.29581241819718, 2.8530565363887, 10.1690767778435, 1.16663198166902, 7.24325924692358, 5.90719991455544, -1.00408647737041, 0.113370509381627, 2.49062098161901, 10.9937120499475, -7.00563818203255, -2.21958148788075, 1.94847971929351, 4.29354002840959, 10.131302270606, 0.0478807226489169, 0.67899552547241, -0.35668730162639, 3.89308655123433, 4.27130411016769, 9.8052343149304, 9.41641366941827, 8.95062023382398, 10.4929491768596, 10.3941904847951, 5.89292766825622, -5.87820694425705, -1.35624476239204, 5.88624845086312, 1.30535264259487, 1.42349176099841, 2.69215331724434, 7.10365328712065, 0.739194696482249, 9.49230276234649, 1.67887901730898, -2.45559436903544, 1.53294272498862, 1.15307461559056, 2.00843933162752, 11.2412450338021, 2.9251138910927, 7.14558318335086, -4.59764716673517, -4.07116415485839, 5.3810569768246, -8.15770776696092, -0.771177345310216, 4.64450000901349, -3.13864826979963, -5.87509571743825, -2.91110814820947, 5.15584081962015, 10.5074469790776, 9.76785787766988, 16.2949528324342, -0.821033940310049, 0.774137519460006, 3.14858016055305, -8.86964520569187, -5.23932003620606, 0.515249736076103, 1.92867687035108, -4.08097130976484, 2.57992455359355, 9.1767006120991, 4.87758868544325, 0.158799670807256, 4.02616736657001, 0.206326402372188, -1.93285462237884, 4.15531218119136, 8.93593251820505, 4.12975464789743, 5.50890198035752, 10.9658674288603, 3.7447886100029, 1.85179934974008, 9.61852691828499, -4.7076409709745, 8.93162551794165, 7.29172445737017, 3.36360408523179, 3.41145626273053, 15.2225159699315, 11.1402280797242, -5.74537031862603, -1.69688035586772, 0.346000941332557, 6.93586500905718, -0.258628965876686, -0.478263764657581, 7.153763547075, 15.7435405672413, 9.12382843202386, 8.68074851130888, -1.24404496278534, 10.3894777507962, -2.24937762822346, -2.61375330003253, 1.69537344056472, 10.2445166303665, 14.6835534384995, 8.75237545097644, 4.06836331159312, 7.01608761481201, 3.87923452489119, 1.49844604063705, -0.863255102916298, 7.97119241960542, -3.86636475980817, 5.28541979652527, 4.1481703508902, 5.82591307140074, 6.61843602903212, 14.1794196514091, -5.43654702743995, -0.809786860238577, -3.70562999687352, 3.0660728799429, 16.8548026111947, 3.80200284991763, 9.39834798756739, 13.8265296055185, 5.37043998666227, 5.3282855692121, 1.37821234580028, -5.06274568331948, -1.26007098414276, -2.76752439808539, 2.12743615525153, 3.90266836127782, 2.46368923368587, -0.620452081668756, 18.4059037078277, 8.88420061977351, -4.73237959903571, 4.6248797349868, -7.45872273071363, 3.34134642679791, 1.47517686844479, -2.5936495549332, 7.58945611874218, 9.2869975286731, 9.74646770041118, 6.70291659028923, -5.3512127988001, 1.23336319885604, 10.1549588385081, -9.25343160170281, -1.36744155662572, 9.30347222660733, 3.33430237608679, 8.66091642357656, 7.00325770014367, 18.6005168028924, -2.87235156912658, -5.93619336261528, -5.0002816295075, 5.1389068937446, -0.739158008707795, 2.82878252111664, 8.44077650161802, 7.11425019654191, 9.69903965995018, 5.91670725048588, -10.3651933991038, -7.53573324318959, 2.39630644004404, 0.0915979882159883, -6.29089215932177, 6.63333936471404, -1.65190094365194, 0.287151362439361, 3.46726201457437, 11.3153355783911, -1.62502013605855, 4.38579908703154, -1.89593180305133, -7.75797223096641, -3.5563469608674, -4.38610431427255, 3.10812634700883, -3.42538644114515, 10.2250624161312, -5.04147451287496, -1.54409808482305, -0.654561759578354, -4.8226660629138, 0.660722137543593, 1.16309143026724, 4.30169547335591, 2.52446601889529, -2.64984097399468, 7.2077027137834, 7.23279872204453, -0.582168292587281, 4.28072532887511, -7.22403973964186, 12.2750729109607, 2.64491740702209, 3.43703051093742, -0.864116591993463, 2.86446114672269, 10.7813805082979, -1.66537440777557, -4.6029103437096, 4.6787120693985, -6.03208255506548, -6.5500043786422, -3.33204959131926, 7.10692796744474, 15.3696444960129, 12.8469951628373, 3.23297185989134, 11.1543144573842, -4.6470319391943, -4.12739085577032, -3.99763256188232, 6.40761774540875, -0.50531926088171, 3.92166686352249, 6.16043075083999, 2.8986682204212, 9.76259633722693, -2.75707567478729, 3.87097561644313, 0.2299561282606, 4.19407720335079, 0.274792103515038, -0.539555939460919, 6.59689180331293, 9.29648923368741, 6.89477120976532, 21.5405848467934, 12.6909680097596, -7.32657343221316, -1.99403846241141, -2.25350725506468, 2.13582472171783, 0.0501320955087032, -3.27134845415514, 2.75303171017318, -5.18553311597807, 3.42018327155421, 15.0300101598408, -4.58469493216297, 1.31444963217049, 1.77485097683747, -2.76400919789119, 0.597678456703334, 6.02987148541422, 5.34575492697777, 16.4426179147456, 12.3957678277444, 5.06054642657768, 1.1922694644721, -12.8776591036697, 7.35729641330711, 2.57479558662636, 6.37335755665437, 8.34363703836853, -2.27208331854744, 13.135886338136, 7.14023821908151, 8.16250260338943, 3.83811116822029, -5.4924973754479, 7.98395715592625, 2.5407472090817, 1.04112657692722, 6.46634364181601, 6.46561622740992, 9.25994290194758, 12.5688303217482, 13.037547927408, -4.99572608788572, 3.68295350328299, -6.04001358828216, 3.85574630671991, 2.1682951700212, 7.14782793826763, 7.02482928148584, 7.0945384479502, 11.5870004310972, 10.8352746128798, -4.23973892123708, 11.1366330986102, 8.53887734357258, -7.25803560996496, -8.05725975771665, 8.6602192644318, 9.10468977004216, -6.55210900159201, -0.56491962074534, 12.3376621964644, -1.36398308948209, -3.90811990404623, 9.53825886974645, 5.67685052064375, 13.0406362659121, 9.10536417313345, 8.0036886258486, 4.07206321049281, 7.31827616303722, 11.5211678559895, 1.8768774755019, 2.57607640749657, -2.32244415573753, 10.3541348787251, -1.79642808520135, 4.3999887845256, 4.8042791677391, 4.53813257698195, 0.948147921645511, 17.509166141868, 5.18978049629718, -7.66929193431719, -2.08304000724199, 0.784199294376514, -1.89063100333488, 2.72626312648959, 7.09033323222804, 11.0492888101142, 3.6875841970666, 17.9089867498382, -7.00417623761669, -7.52018336725738, 3.37682191198445, -0.287320973616564, 0.236869866432621, -4.7460207401151, 13.3509207490648, 3.45366863200285, 8.9965068410944, 8.87161722002526, 1.41938727751696, 1.37536892274157, 3.61554932897189, 0.102182978392775, 0.508842599566208, 1.1453218537337, 0.813466591782222, 12.1835642927117, 8.48446633631613, 12.1571069599641, 5.06917177422071, -1.34509628835135, -0.726274858796468, 2.10864627964394, 0.514281948286359, 0.802950935963558, 5.83428156762863, -1.55733302181806, 6.9635055301443, 17.4256254659779, 1.30457370203304, 2.884754398356, 2.15614947780453, 0.0767599595154458, -0.183867098925157, -3.4008087934124, 2.77192813864312, 14.1596414524398, 9.66577354964005, 0.683540946706281, -4.33893822864165, 4.47589523466663, -0.74717763271465, -10.1678816391668, -1.99616005605564, 10.2883429735372, -1.30920644107116, -1.13244033239149, -2.36561133238318, 6.25958512248848, -5.49937179644762, -5.66174777001303, 0.105173870080047, 0.634675242539882, 10.0624716938992, 6.44937638497782, 7.38206047978325, 7.133867403341, 11.1819047778077, 8.76729940368769, 3.62366244523011, 1.40146803399311, 6.28066422636534, 6.94090217323452, 1.29989415303091, 4.73990837469033, 11.7190047683582, 5.37618509622186, 10.8589959023948, -13.1874882416098, 1.94315888822533, -2.25193036248994, -6.71779124753093, 15.390275634209, -3.30076143299214, 6.87459831875699, 12.9478080647907, 15.7965094221214, 4.39045706579734, 14.2083761173155, 8.88542797266464, 1.87398837647216, -4.414210158199, -11.4790020484941, 0.706801090053915, 8.30293935019014, 4.92936404122752, 2.24907441122429, 5.83526077550923, 4.9676287964107, -1.76120950911856, -8.28844475790264, 0.0649686029262211, -4.7809558076031, 5.14188466231856, 2.78598401011794, 3.87005784986074, 9.79384901526412, -0.107148384620584, 5.13262438594678, -10.8837180313035, 5.92405644396428, -1.25908240680694, -4.20268593307614, 0.16056047597841, -3.91335454670947, 0.504760084064621, -10.4162243838676, 0.399589742890525, 3.92915802327867, -1.79211437732343, -1.96111723099891, 0.2503887088513, 6.79650636624726, -5.99166061808659, -1.422626808877, -7.27893927420784, 14.3397455732721, 2.08253998276598, -8.80484876400217, 2.18049424438115, 0.0653196491422956, -5.51638751199837, -1.94564832698994, 5.90099975670647, -2.54839091985441, 2.70052290685936, -8.17307382765605, 5.42443756882226, -0.381966470937243, 9.48933563815844, -5.31454256757805, -2.02398426866986, -9.24045402451781, -2.89264178013473, -3.13119534312521, -3.98317195057558, 5.39867598927598, 4.72439809326581, 7.67615974316701, -0.0667364339989867, -2.5666048058876, 8.47205615461414, -3.30101432791273, -5.68899011993427, 4.74119251664651, 4.64851807565724, 1.49774518521298, -0.830703163911475, 0.431477686666641, 0.554522583358092, 4.73599120641376, -1.62461525981638, -5.13780681818697, -3.39110515393789, -1.50923338723183, -0.379286647111824, -0.0802637785764027, 3.45939497208061, 4.27164951363722, -6.03928658232076, 9.15037545610662, 1.68216778551569, -3.64923149280236, 7.86999986074826, 3.49169770097785, 9.17479856837362, 4.60880566356091, -3.71460736777294, 2.83010713418971, 0.0368870721799222, -7.2176551837421, -1.40242262357263, 1.55286095155339, -6.30420947288729, 4.56569135797131, 0.963593691643393, 6.82382034532174, -1.27777757720793, -1.10603275355841, -2.80089930628227, -2.31657002316743, -2.41150498476123, 5.99727838163616, -4.15829642440586, -1.06307624903498, -3.82597335002991, 8.91143672808882, 0.919877192469785, -4.35908010908143, 2.8578892990356, -2.27815784247962, -10.0282546040669, 1.62465519039283, 0.212046138409297, 8.88130141473711, 3.19735429618389, -9.78779673271743, -3.35431140355514, 3.42740040924924, 1.26816811321655, -1.60825317021068, -0.539464700517374, 2.44023332884966, 8.16890791423979, 5.1513828127129, -2.82481893182701, 8.06044023146646, 1.2830603082152, -4.53600155625079, 5.67995021802194, -6.13656062696467, 0.815552011542831, -0.247031101515381, -1.86041887231157, 6.63760177823378, -7.48000062518902, 3.45680270894537, -0.539166815165583, 4.35376416832194, 4.71380404320351, -0.665844042837707, 8.90991199169106, 5.75561802690207, 4.68169498668689, 0.311281917508572, -7.19518767351818, 4.48941912022556, 1.90168878895483, -2.93154926523621, 4.9893447244256, 0.394450647517131, -4.95866301303682, 8.18768449992059, 1.87768116793249, 2.91462510128502, -7.23274003703284, -5.34101042188493, -2.62442606561005, 0.26884921028236, -1.03431837766426, -0.752900511698062, 1.2654858388007, 1.98524617664982, -6.23398250464619, 0.862083076517505, 3.87966191889961, 5.41307624505868, 4.98282715071461, -0.693746938884294, 4.08248694548708, 1.76804897451687, 3.44914106355259, -1.36206587830613, 5.75919968781346, 9.57775570182401, -3.04904038747374, -6.37780139428237, 7.93196918230464, 1.71063655810908, -7.60435529623556, -7.07361037707873, 9.53661040360405, 2.38759385777352, -1.10086167393016, 1.01526115484275, 6.32903746872365, 11.1971723888204, -3.90134349740989, 3.43717876730812, -1.91688239977932, -0.452640879239427, 1.92977136129625, 5.62235118047619, 0.395425658687609, 9.42784671934772, 1.0231611543687, 2.17464299626415, -0.636696320111139, -6.42452191027119, -2.33825547726862, -3.60981991847186, 7.86433981058696, -0.572786971410492, -8.88947284582779, -0.374095156775699, -6.04970411027155, 9.55283931915397, 6.12132499680446, -15.11018364716, 2.43638215278069, 0.732356214305699, 5.20397287078376, 6.25931214972492, -0.401205232926862, 2.24114393309928, 1.95963198816006, 1.63284573288928, 4.27875957355014, 11.4963298459877, 0.106410763060545, 0.826184314386372, -4.18220424117236, 7.65286546383943, -0.0608034110308289, -2.96919354460185, 2.35982302634342, -6.15203904836206, 5.59741198443648, -4.57440245829072, -2.87958773673781, 9.05392279462205, 3.92581278580669, 12.622458405976, 0.0770767627971675, 7.49307405436157, 1.09333987222107, 10.2902537896776, 4.11605640360922, 9.81782540983646, 2.00446903738235, 2.71551750003756, -12.6350053352587, -4.59099923517496, 8.71561976230741, 2.68912099079131, -0.558909778399919, -5.36140742925123, 1.68989675486692, -1.55144466479421, -1.69543309509081, -5.24811775247703, -1.83012895900903, -3.63515561987895, -0.752330603347863, 7.27069073767547, -9.1296079896713, 1.50348698741234, -2.09879775404333, -0.98040218676864, -0.903487687850164, -2.64977827577606, -0.312148806713613, 6.52963127077603, -0.659322616708231, 1.34649862296409, -6.79942088909814, -5.40748397230058, 16.6752435497991, -2.72622020114445, 6.11589749618867, 14.4062803303503, 2.80234231653682, -9.36518784366371, -1.40166952815308, -4.77884533945559, 3.86322796814948, -4.51988242483062, 0.747083155237719, 0.58624044840071, -1.8983571894593, -0.307125887897444, -2.38036668932864, -2.33077889107251, 2.82663892359553, -2.78593134159568, 8.32403909097165, 0.134943479374357, 5.53053195348535, 5.45933979285839, 3.11776366297372, 3.03978803520004, 6.24538072775506, 5.04696531908338, 12.0007563288605, 5.02427333219375, 0.335674494811973, -1.80476154972516, 9.39588837738449, 4.57707076474837, 7.14909877519361, 2.82106493491105, 4.49156238087869, 3.00617523426643, 10.0372848109695, 4.38278234847291, 5.40924237263726, 4.78830014681979, 6.20564646857162, -2.51880793670861, -7.10846989227879, 1.47740572660066, -3.14412184786286, -8.02523348982484, -6.27480183563819, 7.35820432915597, 3.23652147384661, -4.95487965656599, -7.83438587801709, 2.43065808884693, -2.55655843881228, 0.304245328857021, 1.75127510435022, 4.97969756156558, 5.16279498594001, -0.620586215808174, -1.19532411172628, 5.58793226195538, -1.50499936012487, 7.08568111012131, -8.11230309946731, -2.62769553480729, -0.663562593625777, -0.359067439610967, 9.61112049600066, -5.63972670270016, 1.89710352450102, -6.6978407782625, 2.45214525972399, -4.9226697817527, 3.46325038331784, -4.56215687805277, -5.37591491602121, 0.440618116629617, -0.926630273176338, 0.900350867333366, -2.56885469464511, -0.811371736553679, -6.46519153904277, -0.480342796850027, -7.26806236649207, -0.546283588682877, 2.01386799830742, 0.620704094361709, 5.97103324510017, 0.807123490077648, -7.30650815234538, 1.24161749666641, -0.56288884395429, 7.16865907501489, 12.686769077869, 2.16914314844434, -5.82254870354546, 3.93000337511656, -7.76048079720147, 0.208566580928978, -0.297075976848806, -1.9527763509701, 4.54711181172449, -1.40971379225204, -8.50162667294502, 8.00608983069707, -2.11373228122289, 1.94197765684309, -1.45288381921731, 2.48706891895925, 1.73549479084608, -3.71197745540759, 3.51083554487464, 1.44916049152632, 7.27821631817468, 6.59862594761767, 1.24427347226349, 8.71866423409543, 5.26988822739668, 2.51182244287577, 0.882713849886099, 0.912717866078211, 5.16030533992629, 2.3271645418249, 1.88156303535427, -0.185989456215935, 4.49519410558713, -2.29056121921692, -5.77867917135683, 1.01419179400026, 1.57568174360107, 2.74159823079071, -1.12414930501741, -1.97333732185077, -0.0516393699356978, 3.70665498608209, -4.06827038519291, 7.29660862318675, -1.49485553619789, 7.73121400736006, -3.07400716837086, -2.26021822757125, 5.16290550588909, -3.11652491794993, 1.27655085789714, 6.43629189177835, 1.50798639972026, -7.84934621947995, -0.624042573349729, -0.910065804064212, -4.55885440486816, -4.95168548296364, 1.64890585590835, 1.84622205063325, 3.80091426024497, -5.97609945266635, -5.11784008884993, 1.06393541680477, -2.26678989106552, -2.38974622911437, 1.8550514244685, -1.74175865661062, -2.11231494140136, -6.49801977103371, 5.50563095564078, 5.20026782174231, 1.03128190249235, 1.83033935545737, -5.45956984340343, -3.79990766795585, 7.01772949520822, 6.62024233510941, -7.77276815233287, -1.70780453312949, -0.580288895754982, -0.785136912433163, -5.20390140011071, 1.06330383118831, 8.25675180618259, -0.993214417104912, 1.31849764139844, 8.65607373095502, 1.79559969862808, 4.9352723753578, -0.730452981905607, -6.18950396320786, -4.98280679256906, -2.62591586112538, 3.88198443218643, -0.470981722371785, -8.67555376783322, -7.80355548555946, 4.1868529368832, 0.563158841973138, 5.2939394187499, 11.0188989526858, -0.854970599309032, 1.95237428971847, 1.80161452253029, -6.9291642825616, 7.98600552923623, 4.48803429689453, 4.65877364343947, 0.527031233142432, -9.16103257420253, 4.60079383571004, -1.29555003118187, -0.618442303149051, -2.40749524751558, 6.49857533701174, 4.23894868074309, -4.77832561625978, -1.81790820691303, -0.798488700766115, -8.59655688375948, -1.6054555506765, 1.59459582932541, 5.14888555523407, -3.61355603727333, -4.25927530576972, 0.189315858905405, 9.00345416664271, -4.3516208710535, 0.703410363421636, 3.29981194239793, 9.04984040555584, -2.06905941828844, 4.73299599773819, -3.39234911527944, 1.64356768769163, 11.4457955918202, 1.39857006064191, -0.0888434523285333, -8.15069597695681, -0.802160975166361, -5.30803706789291, 2.03598463282393, 6.77587159938235, -4.78560684519756, 4.37189765934416, -1.01849900710034, 7.09653397309705, 1.82985673516565, -0.652962951730591, -1.62094161894661, 4.9898140831567, -12.1706586434643, -4.55072605859203, -4.2914977888823, -1.5705743328234, 0.184651021413754, 1.15191842638216, 2.6555481892227, -2.13860674719838, 1.39710622174274, 5.55372322735825, 2.31648991328545, 0.0781111730515693, -0.242098721590291, -6.41948571750539, 7.60383794640657, 9.79805785848832, 6.85946278468794, -0.629225017491688)
result <- cpppar_quf_table_sum(x, y, do_sum_y, rm_0, rm_1, rm_single, only_slope, nthreads, do_refactor, r_x_sizes, obs2keep)
expected_result <- list(quf = list(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 5L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 6L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 7L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 9L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 11L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 12L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 13L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 14L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 15L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 16L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 17L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 18L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 19L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 20L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 21L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 22L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 23L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 24L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 25L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 26L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 27L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 28L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 29L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 30L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 31L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 32L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 33L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 34L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 35L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 36L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 37L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 38L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 39L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 40L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 41L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 42L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 43L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 44L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 45L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 46L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 47L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 48L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 49L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 50L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 51L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 52L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 53L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 54L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 55L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 56L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 57L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 58L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 59L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 60L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 61L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 62L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 63L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 64L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 65L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 66L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 67L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 68L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 69L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 70L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 71L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 72L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 73L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 74L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 75L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 76L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 77L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 78L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 79L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 80L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 81L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 82L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 83L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 84L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 85L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 86L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 87L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 88L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 89L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 90L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 91L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 92L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 93L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 94L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 95L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 96L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 97L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 98L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 99L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 100L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 101L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 102L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 103L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 104L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 105L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 106L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 107L, 108L, 108L, 108L, 108L, 108L, 108L, 108L, 108L, 108L, 108L)), items = list(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108)), table = list(c(10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L, 10L)), sum_y = list(0L))

expect_identical(result, expected_result)
})

