input <- readRDS("dev/input.rds")

# explicitly convert to the right data types

Q <- as.integer(input$Q)

N <- as.integer(input$N)

S <- as.double(input$S)

dumMat <- input$dumMat
storage.mode(dumMat) <- "integer"

nbCluster <- as.integer(input$nbCluster)

orderCluster <- input$orderCluster
storage.mode(orderCluster) <- "integer"

# check the data types
print(paste("Q", class(Q)))
print(paste("N", class(N)))
print(paste("S", class(S)))
print(paste("dumMat", class(dumMat)))
print(paste("nbCluster", class(nbCluster)))
print(paste("orderCluster", class(orderCluster)))

# check dimensions
print(paste("Q", length(Q)))
print(paste("N", length(N)))
print(paste("S", length(S)))
print(paste("dumMat", paste("rows", dim(dumMat)[1], "cols", dim(dumMat)[2])))
print(paste("nbCluster", length(nbCluster)))
print(paste("orderCluster", paste("rows", dim(orderCluster)[1], "cols", dim(orderCluster)[2])))

Rcpp::sourceCpp("dev/01_rcpp_get_fe_gnl.cpp")

rcpp_get_fe_gnl(Q, N, S, dumMat, nbCluster, orderCluster)

# run 1 time

# [[1]]
#  [1] 23.25143 22.44476 24.43460 20.23023 24.32840 23.19499 23.08105 23.75072
#  [9] 24.67546 21.64615 24.96690 24.70769 23.56068 22.50802 23.44093

# [[2]]
#  [1] 3.570083 2.552345 3.230585 0.000000 4.217882 2.588554 3.143755 4.064073
#  [9] 4.168774 2.817644 4.043327 4.322875 2.695877 2.435895 2.451105

# [[3]]
#  [1]  0.00000000  1.41436908  0.65624654  1.44923309 -1.52073341  0.24061915
#  [7]  0.90627290  0.99818202 -0.43707295  0.38013238 -0.69887170 -0.09549963
# [13] -1.94791717 -4.43050543  0.69615767  0.33033306  0.07365566  0.49554792
# [19]  0.94009439  0.80754214

# [[4]]
#  [1] 0.000000000 0.069122284 0.005225473 0.073308208 0.163013386 0.192605170
#  [7] 0.230629376 0.242605404 0.282800683 0.310325692

# [[5]]
# [1] 0 1 1 1

# run 2 times

# [[1]]
#  [1] 23.25143 22.44476 24.43460 20.23023 24.32840 23.19499 23.08105 23.75072
#  [9] 24.67546 21.64615 24.96690 24.70769 23.56068 22.50802 23.44093

# [[2]]
#  [1] 3.570083 2.552345 3.230585 0.000000 4.217882 2.588554 3.143755 4.064073
#  [9] 4.168774 2.817644 4.043327 4.322875 2.695877 2.435895 2.451105

# [[3]]
#  [1]  0.00000000  1.41436908  0.65624654  1.44923309 -1.52073341  0.24061915
#  [7]  0.90627290  0.99818202 -0.43707295  0.38013238 -0.69887170 -0.09549963
# [13] -1.94791717 -4.43050543  0.69615767  0.33033306  0.07365566  0.49554792
# [19]  0.94009439  0.80754214

# [[4]]
#  [1] 0.000000000 0.069122284 0.005225473 0.073308208 0.163013386 0.192605170
#  [7] 0.230629376 0.242605404 0.282800683 0.310325692

# [[5]]
# [1] 0 1 1 1

# run 3 times

# [[1]]
#  [1] 23.25143 22.44476 24.43460 20.23023 24.32840 23.19499 23.08105 23.75072
#  [9] 24.67546 21.64615 24.96690 24.70769 23.56068 22.50802 23.44093

# [[2]]
#  [1] 3.570083 2.552345 3.230585 0.000000 4.217882 2.588554 3.143755 4.064073
#  [9] 4.168774 2.817644 4.043327 4.322875 2.695877 2.435895 2.451105

# [[3]]
#  [1]  0.00000000  1.41436908  0.65624654  1.44923309 -1.52073341  0.24061915
#  [7]  0.90627290  0.99818202 -0.43707295  0.38013238 -0.69887170 -0.09549963
# [13] -1.94791717 -4.43050543  0.69615767  0.33033306  0.07365566  0.49554792
# [19]  0.94009439  0.80754214

# [[4]]
#  [1] 0.000000000 0.069122284 0.005225473 0.073308208 0.163013386 0.192605170
#  [7] 0.230629376 0.242605404 0.282800683 0.310325692

# [[5]]
# [1] 0 1 1 1
